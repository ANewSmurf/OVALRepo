<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.cisecurity:def:5656" version="7">
  <metadata>
    <title>Microsoft SQL Server Remote Code Execution Vulnerability - CVE-2018-8273</title>
    <affected family="windows">
      <platform>Microsoft Windows Server 2012</platform>
      <platform>Microsoft Windows Server 2012 R2</platform>
      <platform>Microsoft Windows Server 2016</platform>
      <platform>Microsoft Windows 8</platform>
      <platform>Microsoft Windows 8.1</platform>
      <platform>Microsoft Windows 10</platform>
      <product>Microsoft SQL Server 2016</product>
      <product>Microsoft SQL Server 2017</product>
    </affected>
    <reference ref_id="CVE-2018-8273" ref_url="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8273" source="CVE" />
    <description>A buffer overflow vulnerability exists in the Microsoft SQL Server that could allow remote code execution on an affected system, aka "Microsoft SQL Server Remote Code Execution Vulnerability." This affects Microsoft SQL Server.</description>
    <oval_repository>
      <dates>
        <submitted date="2018-09-04T08:11:11+00:00">
          <contributor organization="DTCC">Jose Israel Padilla</contributor>
        </submitted>
        <status_change date="2018-09-07T04:03:16.905-04:00">DRAFT</status_change>
        <status_change date="2018-09-21T04:01:02.965-05:00">INTERIM</status_change>
        <status_change date="2018-10-05T04:00:17.937-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria comment="Check for installation vulnerable Microsoft SQL Server + vulnerable file version" operator="OR">
    <criteria comment="Microsoft SQL Server 2016 SP1 is installed + file version" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2016 SP1 is installed" definition_ref="oval:org.cisecurity:def:3017" />
      <criteria comment="Check for file version" operator="OR">
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version is greater than or equal 13.0.4001.0 and less than 13.0.4224.16" test_ref="oval:org.cisecurity:tst:8542" />
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version (CU) is greater than or equal 13.0.4411.0 and less than 13.0.4522.0" test_ref="oval:org.cisecurity:tst:8537" />
      </criteria>
    </criteria>
    <criteria comment="Microsoft SQL Server 2016 SP2 is installed + file version" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2016 SP2 is installed" definition_ref="oval:org.cisecurity:def:5657" />
      <criteria comment="Check for file version" operator="OR">
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version is greater than or equal 13.0.5026.0 and less than 13.0.5081.1" test_ref="oval:org.cisecurity:tst:8540" />
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version (CU) is greater than or equal 13.0.5149.0 and less than 13.0.5201.2" test_ref="oval:org.cisecurity:tst:8541" />
      </criteria>
    </criteria>
    <criteria>
      <extend_definition comment="Microsoft SQL Server 2017 is installed" definition_ref="oval:org.cisecurity:def:3916" />
      <criteria comment="Check for vulnerable range" operator="OR">
        <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is greater than or equal to 14.0.1000.169 and less than 14.0.2002.14" test_ref="oval:org.cisecurity:tst:8538" />
        <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll (CU) is greater than or equal to 14.0.3006.16 and less than 14.0.3035.2" test_ref="oval:org.cisecurity:tst:8539" />
      </criteria>
    </criteria>
  </criteria>
</definition>
